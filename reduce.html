<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-01-04 Mon 12:20 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>(reduce)</title>
<meta name="generator" content="Org mode" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="/assets/js/linktext.js" defer></script>
<script data-goatcounter="https://neeasade.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
<script src="//instant.page/5.1.0" type="module" integrity="sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw"></script>
<link rel='stylesheet' href='/assets/css/org.css?sum=e359ca908a861b1cdcc3e0394ed5bce6'>
<link rel='stylesheet' href='./assets/css/org.css?sum=e359ca908a861b1cdcc3e0394ed5bce6'>
<link rel='stylesheet' href='/assets/css/colors.css?sum=97206a021034a32931377f372160a4ae'>
<link rel='stylesheet' href='./assets/css/colors.css?sum=97206a021034a32931377f372160a4ae'>
<link rel='stylesheet' href='/assets/css/notes.css?sum=31a320c058456258f196266b94ee5dea'>
<link rel='stylesheet' href='./assets/css/notes.css?sum=31a320c058456258f196266b94ee5dea'>
<link rel='stylesheet' href='/assets/css/new.css?sum=6005176a5b1e4f006c15ae303d1f2c3b'>
<link rel='stylesheet' href='./assets/css/new.css?sum=6005176a5b1e4f006c15ae303d1f2c3b'>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<p>
<h1 class=title><a href="/index.html">(reduce)</a> </h1>
</p>

<div class="org-center">
<p>
2020-11-04
</p>
</div>

<hr />
<p>
One habit I had to initially overcome coming to Clojure was a tendency to loop recur all the time instead of reducing. Here's a snippet from #clojure where I came to ask about the habit that I saved from that time:
</p>

<hr />

<p>
<b>neeasade</b> hello all &#x2013; newbie clojure user here, and I've noticed I tend to solve almost all my problems with loop+recur forms.
just wondering if that's like, maybe a sign I'm still doing stuff procedurally.
</p>

<p>
<b>justin_smith</b> neeasade: yeah - for example any time you do (recur (rest x)) is a sign you are doing it the hard way.
clojure has many functions to abstract variants of that pattern (traversing a collection in order) without needing to explicitly do a procedural loop.
then it's a question of learning what the various collection functions are useful for (filter, map, mapcat, reduce, for etc.).
</p>

<p>
<b>neeasade</b> I guess the problem I have is I feel like usually I have a collection of 'moves' or 'ops' that I want to apply to 'state' and have state change along the way.
</p>

<p>
<b>justin_smith</b> that sounds like reduce or reductions to me.
</p>

<p>
<b>neeasade</b> maybe reduce is what I need to get comfy with then (I'm comf with map/reduce/filter).
</p>

<p>
<b>justin_smith</b> it caries a state (usually called an "accumulator" but it can be anything) between each step.
</p>

<p>
<b>neeasade</b> cool &#x2013; thanks, I've use reducing/reducers before, I think I just fell out of habit because it doesn't feel "natural" to me yet.
</p>

<p>
<b>justin_smith</b>:
</p>
<div class="org-src-container">
<pre class="src src-clojure">(reduce
 (<span style="color: #0061d7;">fn</span> [acc i]
   (<span style="color: #0061d7;">let</span> [res (+ acc i)]
     (<span style="color: #0061d7;">if</span> (&gt; res 100) (reduced res) res)))
 0 (range))
<span style="color: #646768;">;; </span><span style="color: #646768;">=&gt; 105</span>
</pre>
</div>

<p>
<b>justin_smith</b> neeasade: also reduce has a built in debugger, you can s/reduce/reductions/.
</p>
<div class="org-src-container">
<pre class="src src-clojure">(reductions
 (<span style="color: #0061d7;">fn</span> [acc i]
   (<span style="color: #0061d7;">let</span> [res (+ acc i)]
     (<span style="color: #0061d7;">if</span> (&gt; res 100) (reduced res) res)))
 0 (range))
<span style="color: #646768;">;; </span><span style="color: #646768;">=&gt; (0 0 1 3 6 ...)</span>
</pre>
</div>

<p>
<b>neeasade</b> thanks justin_smith &#x2013; appreciate it!
</p>

<div class="org-center">
<p>
üçâ
</p>
</div>

<p>
Now, let's compare what this difference looks like with easy-ranked <a href="http://www.4clojure.com/problem/40">4clojure problem</a>:
</p>

<p>
Write a function which separates the items of a sequence by an arbitrary value.
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #646768;">;; </span><span style="color: #646768;">replace the '__'</span>
(= (__ 0 [1 2 3]) [1 0 2 0 3])
(= (apply str (__ <span style="color: #007641;">", "</span> [<span style="color: #007641;">"one"</span> <span style="color: #007641;">"two"</span> <span style="color: #007641;">"three"</span>])) <span style="color: #007641;">"one, two, three"</span>)
(= (__ <span style="color: #0061d7;">:z</span> [<span style="color: #0061d7;">:a</span> <span style="color: #0061d7;">:b</span> <span style="color: #0061d7;">:c</span> <span style="color: #0061d7;">:d</span>]) [<span style="color: #0061d7;">:a</span> <span style="color: #0061d7;">:z</span> <span style="color: #0061d7;">:b</span> <span style="color: #0061d7;">:z</span> <span style="color: #0061d7;">:c</span> <span style="color: #0061d7;">:z</span> <span style="color: #0061d7;">:d</span>])
</pre>
</div>

<p>
Before (bad habits):
</p>

<div class="org-src-container">
<pre class="src src-clojure">(<span style="color: #0061d7;">fn</span> [sep coll &amp; state]
   (<span style="color: #0061d7;">if</span> (= 1 (count coll))
     (conj state (first coll))
     (<span style="color: #0061d7;">recur</span> sep (rest coll)
            (conj (<span style="color: #0061d7;">or</span> state [])
                  (first coll)
                  sep))))
</pre>
</div>

<p>
We're doing a lot of manual management of state here, to carry it through the solution.
</p>

<p>
After:
</p>

<div class="org-src-container">
<pre class="src src-clojure">(<span style="color: #0061d7;">fn</span> [sep coll]
   (butlast
    (reduce (<span style="color: #0061d7;">fn</span> [state next]
              (conj state next sep))
            [] coll)))
</pre>
</div>

<p>
Just gotta remember to embrace reducin', and the implicit carrying of state it gives us.
</p>

<div class="org-center">
<p>
<a href="https://clojuredocs.org/clojure.core/reduce">(reduce)</a>
</p>
</div>

<hr />

<div class="org-center">
<p>
<a href="./index.html">Index</a> <a href="https://neeasade.net">Root</a> <a href="https://raw.githubusercontent.com/neeasade/neeasade.github.io/source/posts/2020-11-04-reduce.org">Source</a> <a href="https://notes.neeasade.net/sitemap.html">Sitemap</a>
</p>
</div>

<div class="org-center">
<a href='https://webring.xxiivv.com/#random' target='_blank'><img style='width:40px;height:40px' src='https://webring.xxiivv.com/icon.black.svg'/></a>
<a href='https://github.com/nixers-projects/sites/wiki/List-of-nixers.net-user-sites' target='_blank'><img style='width:35px;height:40px' src='https://i.imgur.com/cttKKiq.png'/></a>
<a href='https://webring.recurse.com'><img alt='Recurse Center Logo' src='https://resevoir.net/webring/icon.png' style='height:40px;width:40px;'></a>
</div>
</div>
</body>
</html>
